<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<h:head>
    <title>Routenplanung</title>
    <style type="">
        #map {
            height: 700px;
            width: 700px;
        }
    </style>
</h:head>
<body>
<h:form>
    <p:growl id="messages"/>

    <p:menubar>
        <p:menuitem value="Fahrerübersicht" url="/fahreruebersicht.xhtml"/>

        <p:menuitem value="Kunden" url="/kundenuebersicht.xhtml"/>

        <p:submenu label="Aufträge">
            <p:menuitem value="Übersicht" url="/auftragsuebersicht.xhtml"/>
            <p:menuitem value="Auftrag anlegen" url="/auftragAnlegen.xhtml"/>
        </p:submenu>

        <p:menuitem value="Tour" url="http://www.primefaces.org"/>

        <p:menuitem value="Maps" url="/maps.xhtml"/>


        <p:submenu label="Help" icon="ui-icon-help">
            <p:menuitem value="Contents" url="#"/>
            <p:submenu label="Search" icon="ui-icon-search">
                <p:submenu label="Text">
                    <p:menuitem value="Workspace" url="#"/>
                </p:submenu>
                <p:menuitem value="File" url="#"/>
            </p:submenu>
        </p:submenu>

        <f:facet name="options">
            <p:inputText style="margin-right:10px" placeholder="Search"/>
            <p:commandButton type="button" value="Logout" icon="ui-icon-extlink"/>
        </f:facet>
    </p:menubar>
</h:form>

<h:form>
    <p:growl id="growl" life="3000"/>
    <h:outputText value="Startadresse: "/>
    <p:inputText value="#{tourenberechnungBean.startadresse}" id="startZentrale"/>
    <p:inputText id="zwischenziel1" value="#{tourenberechnungBean.adressen.get(0)}"/>
    <p:inputText id="zwischenziel2" value="#{tourenberechnungBean.adressen.get(1)}"/>
    <p:inputText id="zwischenziel3" value="Mosbach"/>
    <h:outputText value="Zieladresse: "/>
    <p:inputText id="zieladresse" value="#{tourenberechnungBean.startadresse}"/>

</h:form>

<button onclick="calcRoute();">Let's Go!</button>

<div id="map"></div>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCISoSZlMcK_DOofSeZF0-CxSyoOEwOypM"
        type="text/javascript"></script>

<script type="text/javascript">
    var map = new google.maps.Map(document.getElementById('map'), {
        center: {lat: 50.111494, lng: 8.680165},
        zoom: 7,
        type: 'HYBRID'
    });

    var directionsService = new google.maps.DirectionsService;
    var directionsDisplay = new google.maps.DirectionsRenderer;

    directionsDisplay.setMap(map);

    function calcRoute(event) {

        var waypts = [];
        var waypts2 = [];

        waypts.push({
            location: $('[id*="zwischenziel1"]').val(),
            stopover: true
        });
        waypts.push({
            location: $('[id*="zwischenziel2"]').val(),
            stopover: true
        });
        if ($('[id*="zwischenziel3"]').val() == "") {

        } else {
            waypts.push({
                location: $('[id*="zwischenziel3"]').val(),
                stopover: true
            });
        }


        waypts2.push({
            location: 'Nürnberg',
            stopover: true
        });
        waypts2.push({
            location: 'München',
            stopover: true
        });


        var directions = {
            origin: $('[id*="startZentrale"]').val(), // Wert aus Inputbox mit jQuery abfragen
            waypoints: waypts,
            optimizeWaypoints: true,
            destination: $('[id*="startZentrale"]').val(),
            travelMode: 'DRIVING',
            unitSystem: google.maps.UnitSystem.METRIC
        };


        directionsService.route(directions, function (result, status) {
            console.log(result);
            console.log(result.geocoded_waypoints);
            console.log(result.routes);

            if (status == 'OK') {
                directionsDisplay.setDirections(result);
            }
        });
    }
</script>
</body>
</html>
